(window["webpackJsonpadmin-area"]=window["webpackJsonpadmin-area"]||[]).push([[0],{160:function(e,t,a){},228:function(e,t,a){e.exports=a(469)},422:function(e,t,a){},469:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(8),l=a.n(c),o=(a(160),a(27)),i=a(115),s=a(22),u=(a(233),a(472)),m=a(473),d=a(156),p=a(5),f=a(19),E=a.n(f),b=a(31),g=a(470),y=a(74),h=a(479),v=a(471),w=a(30),O=a(155),I=a(474),S=a(480),x=a(481),k=a(77),j=a(477),N=a(54),P=a.n(N),C={get:function(e){return P.a.get(e)},post:function(e,t){return P.a.post(e,t)},put:function(e,t){return P.a.put(e,t)},patch:function(e,t){return P.a.patch(e,t)},delete:function(e){return P.a.delete(e)}},D=a(18),T=a(476),A=a(478);var _=D.a.create({name:"AddClass"})((function(e){var t=e.form,a=e.handle_submit,n=t.getFieldDecorator;return r.a.createElement(D.a,{layout:"vertical",className:"zform ant-advanced-search-form",onSubmit:function(e){e.preventDefault(),t.validateFields((function(e,t){e||a(t)}))}},r.a.createElement(D.a.Item,{label:"Classe"},n("class",{rules:[{required:!0,message:"Campo obbligatorio"}]})(r.a.createElement(T.a,{placeholder:"placeholder"}))),r.a.createElement(D.a.Item,{label:"Sezione"},n("section",{rules:[{required:!0,message:"Campo obbligatorio"}]})(r.a.createElement(T.a,{placeholder:"placeholder"}))),r.a.createElement(D.a.Item,{label:"Descrizione"},n("description",{rules:[{required:!0,message:"Campo obbligatorio"}]})(r.a.createElement(T.a,{placeholder:"placeholder"}))),r.a.createElement(D.a.Item,{label:"Numero di studenti"},n("student_number",{rules:[{required:!0,message:"Campo obbligatorio"}]})(r.a.createElement(A.a,{placeholder:"1",min:1}))),r.a.createElement(w.a,{type:"primary",htmlType:"submit"},"Submit"))})),z=r.a.memo((function(e){var t=e.form,a=e.handle_submit,n=e.data,c=t.getFieldDecorator;return r.a.createElement(D.a,{layout:"vertical",className:"zform ant-advanced-search-form",onSubmit:function(e){e.preventDefault(),t.validateFields((function(e,t){e||a(t)}))}},r.a.createElement(D.a.Item,{label:"Username"},c("username",{initialValue:n.username,rules:[{required:!0,message:"Campo obbligatorio"}]})(r.a.createElement(T.a,{placeholder:"placeholder"}))),r.a.createElement(D.a.Item,{label:"Password"},c("password",{initialValue:n.password,rules:[{required:!0,message:"Campo obbligatorio"}]})(r.a.createElement(T.a,{placeholder:"placeholder"}))),r.a.createElement(D.a.Item,{label:"Nome"},c("name",{initialValue:n.name})(r.a.createElement(T.a,{placeholder:"placeholder"}))),r.a.createElement(D.a.Item,{label:"Cognome"},c("surname",{initialValue:n.surname})(r.a.createElement(T.a,{placeholder:"placeholder"}))),r.a.createElement(w.a,{type:"primary",htmlType:"submit"},"Submit"))})),F=D.a.create({name:"EditStudent"})(z),R=a(220),U=a(475);function L(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}var q=D.a.create({name:"AddImage"})((function(e){var t=e.form,a=e.handle_submit,c=Object(n.useState)(null),l=Object(o.a)(c,2),i=l[0],s=l[1],u=t.getFieldDecorator;return r.a.createElement(D.a,{layout:"vertical",className:"zform ant-advanced-search-form",onSubmit:function(e){e.preventDefault(),t.validateFields((function(e,n){e||(t.resetFields(),a(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?L(a,!0).forEach((function(t){Object(R.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):L(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},n,{file:i})))}))}},r.a.createElement(D.a.Item,{label:"Nome"},u("name",{rules:[{required:!0,message:"Campo obbligatorio"}]})(r.a.createElement(T.a,{placeholder:"placeholder"}))),r.a.createElement(D.a.Item,{label:"Description"},u("description",{rules:[{required:!0,message:"Campo obbligatorio"}]})(r.a.createElement(T.a,{placeholder:"placeholder"}))),r.a.createElement(D.a.Item,{label:"Immagine"},u("image",{initialValue:[],valuePropName:"fileList",getValueFromEvent:function(e){return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.fileList},rules:[{required:!0,message:"Campo obbligatorio"}]})(r.a.createElement(U.a,{customRequest:function(e){e.file;var t=e.onSuccess;setTimeout((function(){t("ok")}),0)},beforeUpload:function(e,t){s(t)},listType:"picture",name:"image"},r.a.createElement(w.a,null,r.a.createElement(p.a,{type:"upload"})," Click to upload")))),r.a.createElement(w.a,{type:"primary",htmlType:"submit"},"Submit"))})),V=a(76),B=a(45);var K=D.a.create({name:"ClassSettings"})((function(e){var t=e.classData,a=e.form,c=Object(n.useState)(null),l=Object(o.a)(c,2),i=l[0],s=l[1],u=a.getFieldDecorator,m=function(){var e=Object(b.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,C.delete("".concat(window.API_ENDPOINT.CRUD_CLASS,"/").concat(t));case 3:"OK"===e.sent.data.status&&console.log("deleted");case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(V.a,{gutter:[16,16]},r.a.createElement(B.a,null,r.a.createElement(D.a,{layout:"vertical",className:"zform ant-advanced-search-form",onSubmit:function(e){e.preventDefault(),a.validateFields(function(){var e=Object(b.a)(E.a.mark((function e(a,n){var r,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=12;break}return console.log(n),r=new FormData,i&&i.forEach((function(e){r.append("files[]",e)})),r.append("class",n.class),r.append("section",n.section),r.append("description",n.description),r.append("classId",t.id),e.next=10,C.post(window.API_ENDPOINT.UPDATE_CLASS,r);case 10:c=e.sent,console.log(c);case 12:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}())}},r.a.createElement(D.a.Item,{label:"Classe"},u("class",{initialValue:t.class,rules:[{required:!0,message:"Campo obbligatorio"}]})(r.a.createElement(T.a,{placeholder:"placeholder"}))),r.a.createElement(D.a.Item,{label:"Sezione"},u("section",{initialValue:t.section,rules:[{required:!0,message:"Campo obbligatorio"}]})(r.a.createElement(T.a,{placeholder:"placeholder"}))),r.a.createElement(D.a.Item,{label:"Descrizione"},u("description",{initialValue:t.description,rules:[{required:!0,message:"Campo obbligatorio"}]})(r.a.createElement(T.a,{placeholder:"placeholder"}))),r.a.createElement(D.a.Item,{label:"Immagine"},u("image",{initialValue:[],valuePropName:"fileList",getValueFromEvent:function(e){return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.fileList}})(r.a.createElement(U.a,{customRequest:function(e){e.file;var t=e.onSuccess;setTimeout((function(){t("ok")}),0)},beforeUpload:function(e,t){s(t)},listType:"picture",name:"image"},r.a.createElement(w.a,null,r.a.createElement(p.a,{type:"upload"})," Click to upload")))),r.a.createElement(w.a,{type:"primary",htmlType:"submit"},r.a.createElement(p.a,{type:"edit"})," Modifica")))),r.a.createElement(V.a,{gutter:[16,16]},r.a.createElement(B.a,null,r.a.createElement(g.a,{title:"Vuoi cancellare la classe ?",onConfirm:function(e){return m(t.id)}},r.a.createElement(w.a,{type:"danger"},r.a.createElement(p.a,{type:"delete"})," Elimina la classe")))))}));a(422);function J(){var e=[{title:"Username",dataIndex:"username",key:"username"},{title:"Password",dataIndex:"password",key:"password"},{title:"Nome",dataIndex:"name",key:"name"},{title:"Cognome",dataIndex:"surname",key:"surname"},{title:"Azioni",key:"action",render:function(e,t,a){return r.a.createElement("div",null,r.a.createElement(p.a,{theme:"filled",style:{fontSize:"24px",cursor:"pointer",marginRight:"24px"},type:"edit",onClick:function(){return $(t)}}),r.a.createElement(g.a,{title:"Sure to ?",onConfirm:function(){return Q(t)}},r.a.createElement(p.a,{theme:"filled",style:{fontSize:"24px",cursor:"pointer"},type:"delete"})))}}],t=[{title:"Titolo",key:"name",render:function(e,t,a){return JSON.parse(t.metadata).name}},{title:"Descrizione",key:"description",render:function(e,t,a){return JSON.parse(t.metadata).description}},{title:"Username",key:"ownerId",render:function(e,t,a){var n=l.students.find((function(e){return e.userId===t.ownerId}));return"".concat(n.name," ").concat(n.surname," (").concat(n.username,")")}},{title:"Azioni",key:"action",render:function(e,t,a){return r.a.createElement(r.a.Fragment,null,r.a.createElement(p.a,{theme:"filled",style:{fontSize:"24px",cursor:"pointer",marginRight:"24px"},type:"play-circle",onClick:function(){return window.open("".concat(window.API_ENDPOINT.STORYLET_VIEWER,"/").concat(t.id),"_blank")}}),r.a.createElement(y.a,{placement:"top",title:null===t.status||0===parseInt(t.status)?"Rendi pubblica":"Rendi privata"},r.a.createElement(p.a,{theme:"filled",style:{fontSize:"24px",cursor:"pointer",marginRight:"24px"},type:null===t.status||0===parseInt(t.status)?"eye":"eye-invisible",onClick:function(){return H(t)}})),r.a.createElement(g.a,{title:"Sure to ?",onConfirm:function(){return X(t)}},r.a.createElement(p.a,{theme:"filled",style:{fontSize:"24px",cursor:"pointer"},type:"delete"})))}}],a=Object(n.useState)(null),c=Object(o.a)(a,2),l=c[0],i=c[1],s=Object(n.useState)(null),u=Object(o.a)(s,2),m=u[0],d=u[1],f=Object(n.useState)(null),N=Object(o.a)(f,2),P=N[0],D=N[1],T=Object(n.useState)(!1),A=Object(o.a)(T,2),z=A[0],R=A[1],U=Object(n.useState)(!1),L=Object(o.a)(U,2),V=L[0],B=L[1],J=Object(n.useState)(!1),W=Object(o.a)(J,2),G=W[0],Y=W[1],M=function(){var e=Object(b.a)(E.a.mark((function e(){var t,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae();case 2:t=e.sent,(a=Object.assign({},t[l.idx])).idx=l.idx,i(a);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(b.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,C.put("".concat(window.API_ENDPOINT.CRUD_STORYLET,"/").concat(t.id),{status:1===parseInt(t.status)?0:1});case 3:"OK"===e.sent.data.status&&M();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),X=function(){var e=Object(b.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,C.delete("".concat(window.API_ENDPOINT.CRUD_STORYLET,"/").concat(t.id));case 3:"OK"===e.sent.data.status&&ae();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=function(e){console.log("show student detail"),console.log(e),D(Object.assign({},e)),B(!0)},Q=function(){var e=Object(b.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,C.delete("".concat(window.API_ENDPOINT.CRUD_STUDENT,"/").concat(t.id));case 3:"OK"===e.sent.data.status&&M();case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(){var e=Object(b.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,C.post(window.API_ENDPOINT.CRUD_CLASS,{class:t.class,section:t.section,description:t.description,size:t.student_number});case 3:"OK"===e.sent.data.status&&(R(!1),ae());case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ee=function(){var e=Object(b.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new FormData,t.file.forEach((function(e){a.append("files[]",e)})),a.append("name",t.name),a.append("description",t.description),a.append("classId",l.id),e.next=7,C.post(window.API_ENDPOINT.ADD_IMAGE,a);case 7:"OK"===e.sent.data.status&&(Y(!1),M());case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),te=function(){var e=Object(b.a)(E.a.mark((function e(t){var a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t),e.next=3,C.put("".concat(window.API_ENDPOINT.CRUD_STUDENT,"/").concat(P.id),{username:t.username,password:t.password,name:t.name,surname:t.surname});case 3:"OK"===(a=e.sent).data.status?M():h.a.open({message:"Errore",description:a.data.error}),B(!1),D(null);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();Object(n.useEffect)((function(){ae()}),[]);var ae=function(){var e=Object(b.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C.get(window.API_ENDPOINT.GET_CLASS);case 2:return t=e.sent,d(t.data.data),e.abrupt("return",t.data.data);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),ne=function(){var e=Object(b.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ae();case 2:(t=e.sent)[l.idx].idx=l.idx,i(Object.assign({},t[l.idx]));case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{orientation:"left"},"Le tue classi"),r.a.createElement("div",{className:"class-container"},m&&m.map((function(e,t){return r.a.createElement("div",{onClick:function(e){return function(e){m[e].idx=e,i(Object.assign({},m[e]))}(t)},key:"class_".concat(t),className:"class"},r.a.createElement("div",{style:{width:"100%",textAlign:"center",background:"url(".concat(e.imagePath,")"),backgroundRepeat:"no-repeat",backgroundSize:"cover",height:"100%"}},!e.imagePath&&r.a.createElement("div",null,r.a.createElement(p.a,{theme:"filled",style:{fontSize:"64px",cursor:"pointer"},type:"bank"})),r.a.createElement("div",{style:{position:"absolute",bottom:"10px",width:"calc(100% - 16px)"}},r.a.createElement("div",null,e.class," ",e.section),r.a.createElement("div",null,e.description))))})),r.a.createElement("div",{className:"add-class-container"},r.a.createElement(w.a,{onClick:function(){return R(!0)},type:"primary",className:"add-button"},r.a.createElement(p.a,{type:"plus"})," Aggiungi classe"))),r.a.createElement(v.a,null,"Info ",l?"".concat(l.class," - ").concat(l.section):""),l?r.a.createElement("div",{className:"class-detail"},r.a.createElement(O.a,{tabPosition:"top",animated:!1},r.a.createElement(O.a.TabPane,{tab:r.a.createElement("span",null,r.a.createElement(p.a,{type:"team"}),"Studenti"),key:"1"},r.a.createElement(I.a,{dataSource:l.students,rowKey:"id",columns:e})),r.a.createElement(O.a.TabPane,{tab:r.a.createElement("span",null,r.a.createElement(p.a,{type:"highlight"}),"Storie"),key:"2"},r.a.createElement(w.a,{type:"primary",onClick:ne,loading:!1,style:{marginBottom:"16px"}},r.a.createElement(p.a,{type:"reload"})," Aggiorna"),r.a.createElement(I.a,{dataSource:l.stories,rowKey:"id",columns:t})),r.a.createElement(O.a.TabPane,{tab:r.a.createElement("span",null,r.a.createElement(p.a,{type:"file-image"}),"Immagini"),key:"3"},r.a.createElement(w.a,{onClick:function(){return Y(!0)},type:"primary",style:{marginBottom:16}},r.a.createElement(p.a,{type:"plus"})," Aggiungi immagine"),r.a.createElement(S.a,{grid:{gutter:8,column:5},dataSource:l.images,renderItem:function(e){return r.a.createElement(S.a.Item,null,r.a.createElement(x.a,{title:e.name,bodyStyle:{height:"200px"}},r.a.createElement("img",{src:e.path,style:{height:"calc(100% - 20px)",width:"100%",objectFit:"contain"}}),e.description))}})),r.a.createElement(O.a.TabPane,{tab:r.a.createElement("span",null,r.a.createElement(p.a,{type:"setting"}),"Preferenze"),key:"4"},r.a.createElement(K,{classData:l})))):r.a.createElement(k.a,{description:!1},"Seleziona una classe per accedere alle relative informazioni"),r.a.createElement(j.a,{title:"Aggiungi classe",visible:z,onCancel:function(){return R(!1)},okButtonProps:{style:{display:"none"}},cancelButtonProps:{style:{display:"none"}}},r.a.createElement(_,{handle_submit:Z})),r.a.createElement(j.a,{title:"Info Studente",visible:V,onCancel:function(){return B(!1)},okButtonProps:{style:{display:"none"}},cancelButtonProps:{style:{display:"none"}}},P?r.a.createElement(F,{handle_submit:te,data:P}):null),r.a.createElement(j.a,{title:"Aggiungi immagine",visible:G,onCancel:function(){return Y(!1)},okButtonProps:{style:{display:"none"}},cancelButtonProps:{style:{display:"none"}}},r.a.createElement(q,{handle_submit:ee})))}var W=a(157);function G(){var e=Object(n.useState)(null),t=Object(o.a)(e,2),a=t[0],c=t[1],l=Object(n.useState)(null),i=Object(o.a)(l,2),s=i[0],u=i[1];Object(n.useEffect)((function(){m()}),[]);var m=function(){var e=Object(b.a)(E.a.mark((function e(){var t,a,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.a.get(window.API_ENDPOINT.GET_CLASS,{headers:{"X-WP-Nonce":window.API_NONCE.NONCE}});case 2:t=e.sent,a=[],n=[],t.data.data.forEach((function(e){n=[].concat(Object(W.a)(n),Object(W.a)(e.students)),e.stories.forEach((function(e){1===parseInt(e.status)&&a.push(e)}))})),u(n),c(a);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=[{title:"Titolo",key:"name",render:function(e,t,a){return JSON.parse(t.metadata).name}},{title:"Descrizione",key:"description",render:function(e,t,a){return JSON.parse(t.metadata).description}},{title:"Username",key:"ownerId",render:function(e,t,a){var n=s.find((function(e){return e.userId===t.ownerId}));return"".concat(n.name," ").concat(n.surname," (").concat(n.username,")")}}];return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{orientation:"left"},"Storie pubblicate"),r.a.createElement(I.a,{style:{backgroundColor:"#ffffff",padding:"16px"},dataSource:a,columns:d,rowKey:"id"}))}var Y=u.a.Content,M=u.a.Footer,H=u.a.Sider;var X=function(){var e=Object(n.useState)(!1),t=Object(o.a)(e,2),a=t[0],c=t[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.a,{basename:"".concat(window.API_ENDPOINT.SITE_URL,"admin-area/")},r.a.createElement(u.a,{style:{minHeight:"100vh"}},r.a.createElement(H,{collapsible:!0,collapsed:a,onCollapse:function(e){c(e)}},r.a.createElement("div",{style:{width:"100%",textAlign:"center",padding:"16px"}},r.a.createElement("div",{style:{color:"#ffffff",marginBottom:"8px"}},"Ciao ","".concat(window.USER_INFO.name," ").concat(window.USER_INFO.surname)),r.a.createElement(m.a,{size:64,icon:"user"})),r.a.createElement(d.a,{theme:"dark",defaultSelectedKeys:["1"],mode:"inline"},r.a.createElement(d.a.Item,{key:"1"},r.a.createElement(p.a,{type:"team"}),r.a.createElement("span",null,"Classi"),r.a.createElement(i.b,{to:"/"})),r.a.createElement(d.a.Item,{key:"2"},r.a.createElement(p.a,{type:"highlight"}),r.a.createElement("span",null,"Storie pubblicate"),r.a.createElement(i.b,{to:"/stories"})))),r.a.createElement(u.a,null,r.a.createElement(Y,{className:"site-layout-background",style:{margin:"24px 16px",padding:24}},r.a.createElement(s.a,{exact:!0,path:"/",component:J}),r.a.createElement(s.a,{path:"/stories",component:G})),r.a.createElement(M,{style:{textAlign:"center"}},"Storylet Admin by ISISLab")))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(X,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[228,1,2]]]);
//# sourceMappingURL=main.00fa5af2.chunk.js.map